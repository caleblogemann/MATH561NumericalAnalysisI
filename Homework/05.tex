\documentclass[11pt]{article}
\usepackage[letterpaper, margin = .75in]{geometry}
\usepackage{MATH561}
\usepackage{SetTheory}
\usepackage{Derivative}
\usepackage{Vector}
\usepackage{Complex}
\allowdisplaybreaks


\begin{document}
\noindent \textbf{\Large{Caleb Logemann \\
MATH 561 Numerical Analysis I \\
Homework 5
}}

\begin{enumerate}
    \item % #1
        \begin{enumerate}
            \item[(a)]
                Consider an explicit multistep method of the form
                \[
                    u_{n+2} + \alpha u_{n+1} - \alpha u_{n-1} - u_{n-2} =
                    h\p{\beta f_{n+1} + \gamma f_n + \beta f_{n-1}}
                \]
                Show that the parameters $\alpha, \beta, \gamma$ can be
                chosen uniquely so that the method has order $p = 6$.

                % Hint: to preserve symmetry and algebraic symmplicity define
                % the associated linear functional on the interval [-2, 2] instead
                % of [0, 4] as in Section 6.1.2

            \item[(b)]
                Discuss the stability properties of the method obtained in (a).

                % Outline: use the root condition, examine the roots of \alpha(t)
        \end{enumerate}

    \item % #2
        Construct a pair of four-step methods, one explicit, the other implicit,
        both have $\alpha(\xi) = \xi^4 - \xi^3$ and order $p = 4$,
        but global error constants that are equal in magnitude but opposite in
        sign.

        % See example in Gautschi page 437

    \item % #3
        Consider the model problem
        \[
            \d{y}{x} = -\omega\p{y - a(x)}, 0 \le x \le 1, y(0) = y_0
        \]
        where $\omega > 0$ and (i) $a(x) = x^2$, $y_0 = 0$; and (ii) $a(x) = e^x$, $y_0 = 1$
        \begin{enumerate}
            \item[(a)]
                In each of the cases (i) and (ii), solve the differential
                equation exactly.

                For case (i) this differential equation can be rewritten as
                \[
                    \d{y}{x} = -\omega\p{y - x^2}
                \]
                for $0 \le x \le 1$ and $y(0) = 0$.
                This is equivalent to 
                \[
                    \omega\p{y - x^2} + \d{y}{x} = 0
                \]
                This is not an exact differential equation but it can be made
                into an exact differential equation by multiplying by an
                integrating factor, $\mu(x)$.

                \begin{align*}
                    \mu(x)\omega\p{y - x^2} + \mu(x)\d{y}{x} &= 0 \\
                    \pd{\mu(x)\omega\p{y - x^2}}{y} &= \mu(x) \omega \\
                    \pd{\mu(x)}{x} &= \mu'(x) \\
                    \mu(x) \omega &= \d{\mu}{x} \\
                    \mu(x) &= e^{\omega x}
                    \intertext{This results in the equivalent exact differential equation}
                    e^{\omega x} \omega \p{y - x^2} + e^{\omega x} \d{y}{x} &= 0
                    \intertext{To solve this type of equation a function
                        $\Psi(x, y)$ must be found such that}
                    \pd{\Psi(x, y)}{x} &= e^{\omega x} \omega \p{y - x^2}
                    \intertext{and}
                    \pd{\Psi(x, y)}{y} &= e^{\omega x}
                    \intertext{Solving for $\Psi$}
                    \Psi(x,y) &= \intt{e^{\omega x} \omega \p{y - x^2}}{x} \\
                              &= \intt{\omega y e^{\omega x}}{x} - \intt{\omega e^{\omega x} x^2}{x} + h(y) \\
                              &= y e^{\omega x} - e^{\omega x}\p{\frac{\omega^2 x^2 - 2 \omega x + 2}{\omega^2}} + h(y) \\
                    \pd{\Psi(x,y)}{y} &= e^{\omega x} + h'(y) \\
                    e^{\omega x} + h'(y) &= e^{\omega x} \\
                    h(y) &= C \\
                    \Psi(x,y) &= y e^{\omega x} - e^{\omega x}\p{\frac{\omega^2 x^2 - 2 \omega x + 2}{\omega^2}} + C \\
                \end{align*}
                Now this exact differential equation is equivalent to the equation
                \begin{align*}
                    y e^{\omega x} - e^{\omega x}\p{\frac{\omega^2 x^2 - 2 \omega x + 2}{\omega^2}} &= C \\
                    y e^{\omega x} &= e^{\omega x}\p{\frac{\omega^2 x^2 - 2 \omega x + 2}{\omega^2}} + C \\
                    y(x) &= \frac{\omega^2 x^2 - 2 \omega x + 2}{\omega^2} + e^{-\omega x}C \\
                    y(x) &= x^2 - \frac{2}{\omega} x + \frac{2}{\omega^2} + e^{-\omega x}C \\
                \end{align*}

                Now the initial conditions must be used to solve for $C$.
                \begin{align*}
                    y(0) &= \frac{2}{\omega^2} + C \\
                    0 &= \frac{2}{\omega^2} + C \\
                    C &= -\frac{2}{\omega^2}
                \end{align*}

                Therefore the exact solution to (i) is
                \[
                    y(x) = x^2 - \frac{2}{\omega} x + \frac{2}{\omega^2}\p{1 - e^{-\omega x}} \\
                \]

                For case (ii) this differential equation can be rewritten as
                \[
                    \d{y}{x} = -\omega\p{y - e^x}
                \]
                for $0 \le x \le 1$ and $y(0) = 1$.

                The same integrating factor as in part (i) can be used
                \begin{align*}
                    \omega e^{\omega x}\p{y - e^x} + e^{\omega x}\d{y}{x} &= 0
                    \intertext{To solve this type of equation a function
                        $\Psi(x, y)$ must be found such that}
                    \pd{\Psi(x, y)}{x} &= e^{\omega x} \omega \p{y - e^x}
                    \intertext{and}
                    \pd{\Psi(x, y)}{y} &= e^{\omega x}
                    \intertext{Solving for $\Psi$}
                    \Psi(x, y) &= \intt{e^{\omega x}}{y} \\
                               &= y e^{\omega x} + h(x) \\
                    \pd{\Psi(x,y)}{x} &= \omega y e^{\omega x} + h'(x) \\
                    \omega y e^{\omega x} + h'(x) &= e^{\omega x} \omega \p{y - e^x} \\
                    \omega y e^{\omega x} + h'(x) &= e^{\omega x} \omega y - e^{\omega x} \omega e^x \\
                    h'(x) &=  - \omega e^{(\omega + 1) x} \\
                    h(x) &= - \frac{\omega}{\omega + 1} e^{(\omega + 1) x} + C \\
                    \Psi(x, y) &= y e^{\omega x} - \frac{\omega}{\omega + 1} e^{(\omega + 1) x} + C \\
                \end{align*}
                Now this exact differential equation is equivalent to the equation
                \begin{align*}
                    y e^{\omega x} - \frac{\omega}{\omega + 1} e^{(\omega + 1) x} &= C \\
                    y e^{\omega x} &= \frac{\omega}{\omega + 1} e^{(\omega + 1) x} + C \\
                    y(x) &= e^{-\omega x}\p{\frac{\omega}{\omega + 1} e^{(\omega + 1) x} + C} \\
                    y(x) &= \frac{\omega}{\omega + 1} e^{x} + Ce^{-\omega x} \\
                \end{align*}
                Then the initial conditions can be used to solve for $C$.
                \begin{align*}
                    y(0) &= \frac{\omega}{\omega + 1} + C \\
                    1 &= \frac{\omega}{\omega + 1} + C \\
                    C &= 1 - \frac{\omega}{\omega + 1} \\
                    C &= \frac{1}{\omega + 1}
                \end{align*}

                Thus the exact solution to this differential equation is
                \begin{align*}
                    y(x) &= \frac{\omega}{\omega + 1} e^{x} + \frac{1}{\omega + 1}e^{-\omega x} \\
                    y(x) &= \frac{\omega e^x + e^{-\omega x}}{\omega + 1}\\
                \end{align*}

            \item[(b)]
                In each of the cases (i) and (ii), apply the kth-order Adams-Bashford method and
                kth-order Adams predictor/corrector method, for $k = 4$, using exact starting values and
                step lengths h = 1/20 , 1/40 , 1/80 , 1/160. 
                Plot the exact values $y_n$ and numerical solution $u_n$, and 
                check the accuracy of the methods.
                Try $\omega = 1, 10, 50$.
                Summarize your results.
        \end{enumerate}
\end{enumerate}
\end{document}
